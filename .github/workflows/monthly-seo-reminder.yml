name: Monthly SEO Update Reminder

on:
  schedule:
    # Run on the 1st of every month at 9:00 AM UTC
    - cron: '0 9 1 * *'
  workflow_dispatch: # Allow manual triggering

jobs:
  create-reminder-issue:
    runs-on: ubuntu-latest
    permissions:
      issues: write

    steps:
      - name: Create Monthly SEO Update Issue
        uses: actions/github-script@v7
        with:
          script: |
            const currentDate = new Date().toISOString().split('T')[0];
            const monthYear = new Date().toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

            const issueTitle = `üìä Monthly SEO Update - ${monthYear}`;
            const issueBody = `## Monthly SEO Maintenance Checklist for ${monthYear}

            This is your automated monthly reminder to update the TrendFit website's SEO data.

            ### üåü Update App Store Ratings

            **Location:** \`index.html\` lines 75-81

            **Current Values:**
            \`\`\`json
            "aggregateRating": {
              "@type": "AggregateRating",
              "ratingValue": "5.0",
              "ratingCount": "7",
              "bestRating": "5",
              "worstRating": "1"
            }
            \`\`\`

            **Steps:**
            1. Visit [App Store Connect](https://appstoreconnect.apple.com/)
            2. Navigate to TrendFit app ‚Üí Ratings & Reviews
            3. Note the current:
               - Average rating (update \`ratingValue\`)
               - Total number of ratings (update \`ratingCount\`)
            4. Update \`index.html\` with new values
            5. Commit changes with message: \`chore: Update App Store ratings for ${monthYear}\`

            ### üìÖ Update Sitemap Last Modified Date

            **Location:** \`sitemap.xml\` line 6

            **Steps:**
            1. Update \`<lastmod>${currentDate}</lastmod>\` for homepage if content changed
            2. Review and update other pages if modified this month

            ### ‚úÖ Verify All Links

            **Steps:**
            1. Check that all social media links are still active
            2. Verify App Store download link works
            3. Test Open Graph image is loading correctly

            ### üîç Review & Test

            - [ ] Updated aggregateRating in index.html
            - [ ] Tested schema with [Google Rich Results Test](https://search.google.com/test/rich-results)
            - [ ] Verified sitemap.xml is current
            - [ ] All social links tested
            - [ ] Changes committed and pushed

            ---

            **üìñ Documentation:** See \`.github/SEO-MAINTENANCE.md\` for detailed instructions.

            *This issue was automatically created by the Monthly SEO Update Reminder workflow.*
            `;

            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: issueTitle,
              body: issueBody,
              labels: ['maintenance', 'seo', 'automated']
            });
